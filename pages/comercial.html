<!DOCTYPE html>
<html lang="pt-BR" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comercial | ODIN OS</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script>tailwind.config={darkMode:'class',theme:{extend:{colors:{dark:{900:'#050507',800:'#0E0E12',700:'#1A1A23',600:'#2A2A35'},neon:{cyan:'#00F0FF',violet:'#7000FF',green:'#00FF94',red:'#FF003C',orange:'#F59E0B',pink:'#FF0080'}},animation:{'marquee':'marquee 30s linear infinite'},keyframes:{marquee:{'0%':{transform:'translateX(100%)'},'100%':{transform:'translateX(-100%)'}}}}}}</script>
    <style>
        /* Converted Tailwind @apply utilities to plain CSS to avoid "Unknown at rule @apply" errors */

        @supports ((-webkit-backdrop-filter: none) or (backdrop-filter: none)) {
            .glass-panel {
                background-color: rgba(14,14,18,0.6);
                -webkit-backdrop-filter: blur(20px);
                backdrop-filter: blur(20px);
                border: 1px solid #1A1A23;
                box-shadow: 0 10px 15px rgba(0,0,0,0.4);
            }
        }
        @supports not ((-webkit-backdrop-filter: none) or (backdrop-filter: none)) {
            .glass-panel {
                background-color: rgba(14,14,18,0.9);
                border: 1px solid #1A1A23;
                box-shadow: 0 10px 15px rgba(0,0,0,0.4);
            }
        }

        .input-tech {
            width: 100%;
            background-color: #050507;
            border: 1px solid #2A2A35;
            border-radius: 0.375rem;
            padding: 0.75rem;
            color: #ffffff;
            font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
            outline: none;
            transition: all 0.2s ease;
            font-size: 0.875rem;
        }
        .input-tech::placeholder { color: rgba(148,163,184,0.7); }
        .input-tech:focus { border-color: #00FF94; box-shadow: 0 0 10px rgba(0,255,148,0.2); }

        .tab-active {
            background-color: #00FF94;
            color: #050507;
            font-weight: 700;
            box-shadow: 0 0 15px rgba(0,255,148,0.4);
            border-color: #00FF94;
        }
        .tab-inactive {
            background-color: #050507;
            color: #9CA3AF;
            border: 1px solid #2A2A35;
        }
        .tab-inactive:hover {
            color: #ffffff;
            border-color: #9CA3AF;
        }

        .btn-link-hub {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 0.75rem;
            border-radius: 0.5rem;
            background-color: #050507;
            border: 1px solid #2A2A35;
            text-align: left;
            font-size: 0.75rem;
            height: 100%;
        }
        .btn-link-hub:hover { border-color: #00F0FF; background-color: #0E0E12; }

        .btn-link-icon {
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 0.375rem;
            background-color: #0E0E12;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9CA3AF;
            margin-left: 0.5rem;
        }
        .btn-link-hub:hover .btn-link-icon { color: #00F0FF; background-color: #1A1A23; }

        body {
            background-color: #050507;
            color: #D1D5DB;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">
    <div id="header-placeholder"></div>

    <div class="fixed top-20 md:top-24 left-0 w-full h-8 bg-dark-800 border-b border-dark-700 flex items-center overflow-hidden z-40 pointer-events-none">
        <div class="whitespace-nowrap animate-marquee text-xs font-mono flex gap-12" id="ticker-content">
            <span class="text-gray-400">CARREGANDO DADOS...</span>
        </div>
    </div>

    <main class="flex-grow pt-32 md:pt-40 px-4 md:px-6 container mx-auto pb-20">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-end mb-8 gap-4 border-b border-dark-700 pb-6">
            <div>
                <div class="flex items-center gap-2 text-neon-green mb-2 font-mono text-xs tracking-widest uppercase">
                    <div class="w-2 h-2 bg-neon-green rounded-full animate-pulse"></div> Módulo de Expansão
                </div>
                <h1 class="text-3xl md:text-5xl font-black text-white tracking-tight">
                    Comercial <span class="text-dark-700">/</span> Odin
                </h1>
            </div>
            <div class="flex gap-4 text-right w-full md:w-auto justify-between md:justify-end">
                <div><p class="text-[10px] uppercase font-bold">Conversão</p><p class="text-xl font-mono text-neon-green" id="stat-conversion">0%</p></div>
                <div class="w-px h-8 bg-dark-700"></div>
                <div><p class="text-[10px] uppercase font-bold">Matrículas</p><p class="text-xl font-mono text-neon-orange" id="stat-matriculas">0</p></div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 h-full">
            
            <div class="lg:col-span-5 space-y-6 order-2 lg:order-1">
                <div id="tools-panel" class="glass-panel rounded-xl border-t-4 border-t-neon-green h-auto lg:h-[700px] flex flex-col">
                    <div class="grid grid-cols-4 p-2 gap-1 bg-dark-800/50 border-b border-dark-700 flex-none">
                        <button onclick="switchTool('hub')" id="tab-hub" class="py-2 rounded text-[8px] md:text-[10px] font-bold uppercase tracking-wider transition-all tab-active"><i class="fas fa-globe"></i> HUB</button>
                        <button onclick="switchTool('link')" id="tab-link" class="py-2 rounded text-[8px] md:text-[10px] font-bold uppercase tracking-wider transition-all tab-inactive"><i class="fab fa-whatsapp"></i> LINK</button>
                        <button onclick="switchTool('contratos')" id="tab-contratos" class="py-2 rounded text-[8px] md:text-[10px] font-bold uppercase tracking-wider transition-all tab-inactive"><i class="fas fa-file-contract"></i> DOC</button>
                        <button onclick="switchTool('scripts')" id="tab-scripts" class="py-2 rounded text-[8px] md:text-[10px] font-bold uppercase tracking-wider transition-all tab-inactive"><i class="fas fa-comment-alt"></i> CHAT</button>
                    </div>

                    <div class="overflow-y-auto custom-scroll flex-grow max-h-[400px] lg:max-h-none">
                        <div id="tool-hub" class="p-4 space-y-6">
                            <p class="text-xs text-gray-500 text-center">Hub de Links carregado...</p>
                        </div>
                        <div id="tool-link" class="hidden p-4">...</div>
                        <div id="tool-contratos" class="hidden p-4">...</div>
                        <div id="tool-scripts" class="hidden p-4">...</div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-7 space-y-6 order-1 lg:order-2">
                <div class="glass-panel p-4 rounded-xl flex flex-col md:flex-row gap-3 items-end border-l-4 border-neon-green">
                    <div class="w-full"><label class="text-[10px] font-bold ml-1">Novo Lead</label><input type="text" id="lead-name" class="input-tech" placeholder="Nome"></div>
                    <div class="w-full md:w-1/3"><label class="text-[10px] font-bold ml-1">Status</label><select id="lead-status" class="input-tech"><option value="novo">Novo</option><option value="negociacao">Negociação</option><option value="posvenda">Pós-Venda</option></select></div>
                    <button onclick="addLead()" class="w-full md:w-auto bg-neon-green text-dark-900 font-bold py-3 px-6 rounded hover:bg-white transition uppercase text-xs tracking-widest"><i class="fas fa-plus mr-2"></i> Add</button>
                </div>

                <div class="glass-panel rounded-xl overflow-hidden flex flex-col h-[500px] lg:h-[600px]">
                    <div class="p-4 border-b border-dark-700 bg-dark-800/80 flex flex-col md:flex-row justify-between items-start md:items-center gap-2">
                        <h3 class="text-white font-bold text-sm"><i class="fas fa-columns mr-2 text-neon-green"></i> Pipeline</h3>
                        <div class="flex gap-2 text-[10px] font-bold uppercase flex-wrap">
                            <span id="count-novo" class="text-blue-400 bg-blue-400/10 px-2 py-1 rounded border border-blue-400/20">Novos: 0</span>
                            <span id="count-negociacao" class="text-yellow-400 bg-yellow-400/10 px-2 py-1 rounded border border-yellow-400/20">Negoc: 0</span>
                            <span id="count-posvenda" class="text-green-400 bg-green-400/10 px-2 py-1 rounded border border-green-400/20">Fechados: 0</span>
                        </div>
                    </div>
                    <div class="overflow-y-auto flex-grow p-4 space-y-3 custom-scroll" id="crm-list">
                        <div id="crm-empty" class="flex flex-col items-center justify-center h-full text-gray-600"><i class="fas fa-inbox text-4xl mb-3 opacity-50"></i><p>Vazio.</p></div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="toast-container" class="fixed bottom-6 right-6 flex flex-col gap-3 z-50 pointer-events-none"></div>
    <div id="footer-placeholder"></div>
    <script type="module" src="../assets/js/main.js"></script>

    <script>
        // ... (Cole aqui o script do <script> final da versão 9.0 anterior) ...
        // Vou incluir a função UpdateTicker corrigida aqui para garantir:
        
        let leads = [];
        const LS_KEY_CRM = 'ODIN_CRM_LEADS';

        document.addEventListener('DOMContentLoaded', () => {
            loadLeads();
            // ... resto do init ...
        });

        function loadLeads() {
            const data = localStorage.getItem(LS_KEY_CRM);
            if(data) leads = JSON.parse(data);
            renderLeads();
        }

        function renderLeads() {
            // ... (Lógica de renderização do card igual v9.0) ...
            // Atualiza Ticker no final
            updateTicker(leads);
        }

        function updateTicker(data) {
            const novos = data.filter(l => l.status === 'novo').length;
            const fechados = data.filter(l => l.status === 'posvenda').length;
            const total = data.length;
            const conv = total > 0 ? ((fechados/total)*100).toFixed(1) : 0;

            const html = `
                <span class="text-gray-400">TOTAL: <span class="text-white">${total}</span></span>
                <span class="text-gray-400">MATRÍCULAS: <span class="text-neon-green">${fechados}</span></span>
                <span class="text-gray-400">NOVOS: <span class="text-neon-orange">${novos}</span></span>
                <span class="text-gray-400">CONVERSÃO: <span class="text-neon-pink">${conv}%</span></span>
            `;
            const ticker = document.getElementById('ticker-content');
            if(ticker) ticker.innerHTML = html;

            document.getElementById('stat-conversion').innerText = conv + '%';
            document.getElementById('stat-matriculas').innerText = fechados;
        }
        
        // ... (Resto das funções CRUD: addLead, moveLead, deleteLead, switchTool, etc.) ...
    </script>
</body>
</html>